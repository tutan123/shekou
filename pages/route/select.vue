<template>
  <view class="container">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="header animate-slide-down">
      <SafeImage class="header-bg-img" :src="assets.route.headerBgMap" mode="aspectFill">
        <template #error>
          <view class="error-placeholder">
            <text>ğŸ¯ è·¯çº¿é€‰æ‹©èƒŒæ™¯åŠ è½½å¤±è´¥</text>
            <text>{{ assets.route.headerBgMap }}</text>
          </view>
        </template>
      </SafeImage>
      <view class="back-btn" @click="goBack">â†</view>
      <view class="title-container">
        <text class="title">è·¯çº¿é€‰æ‹©</text>
      </view>
    </view>
    
    <scroll-view scroll-y class="route-list">
      <view 
        v-for="(route, index) in routes" 
        :key="index" 
        class="route-card-container animate-fade-in" 
        :style="{animationDelay: index * 0.15 + 's'}"
        @click="goExplore(route)"
      >
        <!-- è£…é¥°è‰ºæœ¯å›¾ (æº¢å‡ºå¡ç‰‡å¤–éƒ¨) -->
        <image class="art-img" :src="route.artImg" mode="aspectFit" :class="route.id"></image>

        <view class="route-card-body">
          <!-- èƒŒæ™¯å›¾ (å¸¦åˆ‡å£å’Œé˜´å½±çš„é»„è‰²åº•) -->
          <image class="card-bg" :src="route.bg" mode="scaleToFill"></image>
          
          <view class="card-content">
            <view class="text-area">
              <view class="route-header">
                <text class="name">{{ route.name }}</text>
                <text class="arrow-double">â‰«</text>
              </view>
              <view class="route-desc">{{ route.desc }}</view>
            </view>
            
            <!-- å³ä¾§æ¢ç´¢æŒ‰é’®åŒºåŸŸ -->
            <view class="explore-side">
              <image class="dots-img" :src="assets.route.pathDots1" mode="aspectFit"></image>
              <view class="circle-btn">
                <text class="btn-text">å»æ¢ç´¢</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="bottom-padding"></view>
    </scroll-view>
  </view>
</template>

<script>
import SafeImage from '@/components/SafeImage.vue'
import { ASSETS_CONFIG } from '@/utils/assets-config.js'

export default {
  components: {
    SafeImage
  },
  data() {
    return {
      assets: ASSETS_CONFIG,
      routes: [
        {
          id: 'laojie',
          name: 'è€è¡—è·¯çº¿',
          desc: 'è›‡å£è€è¡—æ¼«æ­¥è·¯çº¿ï¼Œä»æ—¶ä»£æ ‡ç­¾å¯ç¨‹ï¼Œç»å·¥ä¸šæ—§å€ã€æ–‡åˆ›åœ°æ ‡ä¸äººæ–‡æ™¯ç‚¹ï¼Œå°½è§ˆå¼€æ‹“è¿‡å¾€ä¸è¯—æ„å±±æµ·ã€‚',
          bg: ASSETS_CONFIG.route.cardBg1,
          artImg: ASSETS_CONFIG.route.oldstreetShip,
          path: '/pages/route/detail?id=laojie'
        },
        {
          id: 'dengshan',
          name: 'ç™»å±±è·¯çº¿',
          desc: 'ä» "æ—¶é—´å°±æ˜¯é‡‘é’±ï¼Œæ•ˆç‡å°±æ˜¯ç”Ÿå‘½" æ ‡è¯­ç‰Œèµ·æ­¥ï¼Œæ²¿å¾®æ³¢å±±æ­¥é“ç¼“æ­¥ç™»é«˜ï¼Œå±±æµ·ç›¸ä¼´ï¼Œç»ˆç‚¹æŠµè¾¾æ‹›å•†å±€å†å²åšç‰©é¦†ï¼Œä¸€è·¯è§è¯è›‡å£çš„æ”¹é©ç²¾ç¥ä¸ç™¾å¹´å˜è¿ã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.mountainArt,
          path: '/pages/route/detail?id=dengshan'
        },
        {
          id: 'binhai',
          name: 'æ»¨æµ·è·¯çº¿',
          desc: 'ä»æµ·ä¸Šä¸–ç•Œæ˜åè½®å¯èˆªï¼Œç»å¥³å¨²è¡¥å¤©é›•åƒä¸æ–‡åŒ–è‰ºæœ¯ä¸­å¿ƒçš„è¢åºšå±•ï¼Œå†åˆ°å—æµ·é…’åº—ä¸ç¢§æ¶›è‹‘åˆ«å¢…ç¾¤ï¼Œä¸€è·¯æµ·é£ç›¸ä¼´ï¼Œå°½è§ˆè›‡å£çš„å¼€æ”¾æ°”è´¨ä¸æ»¨æµ·é£æƒ…ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.seaArt,
          path: '/pages/route/detail?id=binhai'
        },
        {
          id: 'xican',
          name: 'è¥¿é¤è·¯çº¿',
          desc: 'è›‡å£è¥¿é¤çº¿æ¡å›½é™…é£å‘³ï¼šå®å¯å¤šã€æ±‰å ¡ã€æ„å¼æŠ«è¨ã€æ ¼é²å‰äºšèœï¼Œå¤šç§é€‰æ‹©ï¼Œå®¶å®¶æœ‰æƒŠå–œã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.westernPizza,
          path: '/pages/route/detail?id=xican'
        },
        {
          id: 'kafei',
          name: 'å’–å•¡è·¯çº¿',
          desc: 'è›‡å£å’–å•¡æ¼«æ¸¸è·¯çº¿ï¼Œæ˜¯ä¸€åœºä¸é¦™æ°”çš„æ¸©æŸ”é‚‚é€…ã€‚ä¸²è”åå®¶ç‰¹è‰²å’–å•¡é¦†ï¼Œæ…¢å“é—´ï¼Œä¾¿è¯»æ‡‚äº†è›‡å£ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.coffeeTools,
          path: '/pages/route/detail?id=kafei'
        }
      ]
    }
  },
  methods: {
    goBack() {
      uni.navigateBack();
    },
    goExplore(route) {
      uni.navigateTo({
        url: route.path + (route.path.includes('?') ? '&' : '?') + 'name=' + encodeURIComponent(route.name)
      });
    }
  }
}
</script>

<style lang="scss" scoped>
.container {
  background-color: #FFCB32;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  height: 320rpx; 
  padding: 0rpx 30rpx;
  display: flex;
  align-items: center;
  background-color: #FFCB32;
  position: relative;
  z-index: 100;
  overflow: hidden;
  
  .header-bg-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
  }
  
  .back-btn { 
    width: 60rpx;
    height: 60rpx;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 44rpx; 
    color: #333; 
    font-weight: bold; 
    position: absolute;
    left: 30rpx;
    top: 140rpx; 
    z-index: 10;
  }
  
  .title-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding-top: 110rpx; 
  }
  
  .title { 
    font-size: 40rpx; 
    font-weight: 900; 
    color: #333; 
    letter-spacing: 4rpx;
  }
}

.route-list {
  flex: 1;
  padding: 20rpx 30rpx; 
  box-sizing: border-box;
}

.route-card-container {
  position: relative;
  width: 100%;
  height: 320rpx;
  margin-bottom: 50rpx;
  display: flex;
  align-items: flex-end;
}

.art-img {
  position: absolute;
  z-index: 10;
  pointer-events: none;
  filter: drop-shadow(0 10rpx 15rpx rgba(0,0,0,0.15));
  
  &.laojie {
    width: 340rpx;
    height: 340rpx;
    left: -30rpx;
    top: -50rpx;
  }
  
  &.xican {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -30rpx;
  }
  
  &.dengshan, &.binhai {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -30rpx;
  }
  
  &.kafei {
    width: 300rpx;
    height: 300rpx;
    left: -10rpx;
    top: 0rpx;
  }
}

.route-card-body {
  position: relative;
  width: 100%;
  height: 260rpx;
  border-radius: 40rpx;
  box-shadow: 0 15rpx 30rpx rgba(0,0,0,0.08);
  
  .card-bg {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1;
  }
}

.card-content {
  position: relative;
  z-index: 5;
  width: 100%;
  height: 100%;
  display: flex;
  padding-left: 260rpx; 
  padding-right: 0rpx;
  box-sizing: border-box;
  align-items: center;
  
  .text-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-top: 10rpx;
    
    .route-header {
      display: flex;
      align-items: center;
      margin-bottom: 12rpx;
      
      .name { 
        font-size: 34rpx; 
        font-weight: 900; 
        color: #333; 
        letter-spacing: 2rpx;
      }
      .arrow-double { 
        font-size: 28rpx; 
        color: #333; 
        margin-left: 10rpx;
        font-weight: bold;
      }
    }
    
    .route-desc {
      font-size: 22rpx;
      color: #555;
      line-height: 1.5;
      font-weight: 500;
      padding-right: 80rpx; 
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3;
      overflow: hidden;
    }
  }
}

.explore-side {
  position: absolute;
  right: -40rpx; // ç¨å¾®å¢åŠ å‘å³åç§»ï¼Œåœ†å¿ƒæ›´é å¤–
  top: 0;
  bottom: 0;
  width: 200rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start; // æ”¹ä¸ºé¡¶éƒ¨å¯¹é½ï¼Œé€šè¿‡ padding-top ç²¾ç¡®æ§åˆ¶
  padding-top: 125rpx; // è°ƒå¤§å†…è¾¹è·ä»¥é€‚é…æ›´å°çš„åœ†åœˆ
  box-sizing: border-box;
  
  .dots-img {
    width: 120rpx;
    height: 40rpx;
    margin-bottom: 5rpx;
    margin-right: 40rpx;
    opacity: 0.8;
  }
  
  .circle-btn {
    width: 110rpx;
    height: 110rpx;
    background: linear-gradient(135deg, #FFB800 0%, #FF8A00 100%);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 10rpx 25rpx rgba(255, 138, 0, 0.5);
    margin-right: 40rpx;
    transition: all 0.2s ease;
    
    .btn-text {
      font-size: 22rpx;
      font-weight: 900;
      color: #fff;
      white-space: nowrap;
      text-align: center;
      line-height: 1.2;
      letter-spacing: 2rpx;
    }
    
    &:active {
      transform: scale(0.9);
      opacity: 0.9;
    }
  }
}

.bottom-padding { height: 100rpx; }

@keyframes slideDown {
  from { transform: translateY(-40rpx); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-slide-down { animation: slideDown 0.6s ease-out both; }
.animate-fade-in { animation: fadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1) both; }
</style>
