<template>
  <view class="container">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="header animate-slide-down" :style="{ paddingTop: statusBarHeight + 'px' }">
      <SafeImage class="header-bg-img" :src="assets.route.headerBgMap" mode="aspectFill">
        <template #error>
          <view class="error-placeholder">
            <text>ğŸ¯ è·¯çº¿é€‰æ‹©èƒŒæ™¯åŠ è½½å¤±è´¥</text>
            <text>{{ assets.route.headerBgMap }}</text>
          </view>
        </template>
      </SafeImage>
      <view class="back-btn" :style="{ top: (statusBarHeight + 10) + 'px' }" @click="goBack">â†</view>
      <view class="title-container">
        <text class="title">è·¯çº¿é€‰æ‹©</text>
      </view>
    </view>
    
    <scroll-view scroll-y class="route-list">
      <view 
        v-for="(route, index) in routes" 
        :key="index" 
        class="route-card-container animate-fade-in" 
        :style="{animationDelay: index * 0.15 + 's'}"
        @click="goExplore(route)"
      >
        <!-- è£…é¥°è‰ºæœ¯å›¾ (æº¢å‡ºå¡ç‰‡å¤–éƒ¨) -->
        <image class="art-img" :src="route.artImg" mode="aspectFit" :class="route.id"></image>

        <view class="route-card-body">
          <!-- èƒŒæ™¯å›¾ (å¸¦åˆ‡å£å’Œé˜´å½±çš„é»„è‰²åº•) -->
          <image class="card-bg" :src="route.bg" mode="scaleToFill"></image>
          
          <view class="card-content">
            <view class="text-area">
              <view class="route-header">
                <text class="name">{{ route.name }}</text>
                <text class="arrow-double">â‰«</text>
              </view>
              <view class="route-desc">{{ route.desc }}</view>
            </view>
            
            <!-- å³ä¾§æ¢ç´¢æŒ‰é’®åŒºåŸŸ -->
            <view class="explore-side">
              <view class="circle-btn">
                <text class="btn-text">å»æ¢ç´¢</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="bottom-padding"></view>
    </scroll-view>
  </view>
</template>

<script>
import SafeImage from '@/components/SafeImage.vue'
import { ASSETS_CONFIG } from '@/utils/assets-config.js'

export default {
  components: {
    SafeImage
  },
  data() {
    return {
      assets: ASSETS_CONFIG,
      statusBarHeight: 0,
      routes: [
        {
          id: 'laojie',
          name: 'è€è¡—è·¯çº¿',
          desc: 'è›‡å£è€è¡—æ¼«æ­¥è·¯çº¿ï¼Œä»æ—¶ä»£æ ‡ç­¾å¯ç¨‹ï¼Œç»å·¥ä¸šæ—§å€ã€\næ–‡åˆ›åœ°æ ‡ä¸äººæ–‡æ™¯ç‚¹ï¼Œå°½è§ˆå¼€æ‹“è¿‡å¾€ä¸è¯—æ„å±±æµ·ã€‚',
          bg: ASSETS_CONFIG.route.cardBg1,
          artImg: ASSETS_CONFIG.route.oldstreetShip,
          path: '/pages/route/detail?id=laojie'
        },
        {
          id: 'dengshan',
          name: 'ç™»å±±è·¯çº¿',
          desc: 'ä» "æ—¶é—´å°±æ˜¯é‡‘é’±ï¼Œæ•ˆç‡å°±æ˜¯ç”Ÿå‘½"\næ ‡è¯­ç‰Œèµ·æ­¥ï¼Œæ²¿å¾®æ³¢å±±æ­¥é“ç¼“æ­¥ç™»é«˜ï¼Œ\nå±±æµ·ç›¸ä¼´ï¼Œç»ˆç‚¹æŠµè¾¾æ‹›å•†å±€å†å²åšç‰©é¦†ã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.mountainArt,
          path: '/pages/route/detail?id=dengshan'
        },
        {
          id: 'binhai',
          name: 'æ»¨æµ·è·¯çº¿',
          desc: 'ä»æµ·ä¸Šä¸–ç•Œæ˜åè½®å¯èˆªï¼Œç»å¥³å¨²è¡¥å¤©é›•åƒã€\næ–‡åŒ–è‰ºæœ¯ä¸­å¿ƒï¼Œå†åˆ°å—æµ·é…’åº—ï¼Œ\nä¸€è·¯æµ·é£ç›¸ä¼´ï¼Œå°½è§ˆè›‡å£æ»¨æµ·é£æƒ…ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.seaArt,
          path: '/pages/route/detail?id=binhai'
        },
        {
          id: 'xican',
          name: 'è¥¿é¤è·¯çº¿',
          desc: 'è›‡å£è¥¿é¤çº¿æ¡å¤šå›½é£å‘³ï¼šå®å¯å¤šã€æ±‰å ¡ã€æ„å¼æŠ«è¨ã€\næ ¼é²å‰äºšèœï¼Œå¤šç§é€‰æ‹©ï¼Œå®¶å®¶æœ‰æƒŠå–œã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.westernPizza,
          path: '/pages/route/detail?id=xican'
        },
        {
          id: 'kafei',
          name: 'å’–å•¡è·¯çº¿',
          desc: 'è›‡å£å’–å•¡æ¼«æ¸¸è·¯çº¿ï¼Œæ˜¯ä¸€åœºä¸é¦™æ°”çš„æ¸©æŸ”é‚‚é€…ã€‚\nä¸²è”åå®¶ç‰¹è‰²å’–å•¡é¦†ï¼Œæ…¢å“é—´ï¼Œ\nä¾¿è¯»æ‡‚äº†è›‡å£ç‹¬æœ‰çš„æƒ¬æ„ä¸æµªæ¼«ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.coffeeTools,
          path: '/pages/route/detail?id=kafei'
        }
      ]
    }
  },
  onLoad() {
    // è·å–çŠ¶æ€æ é«˜åº¦
    const info = uni.getSystemInfoSync();
    this.statusBarHeight = info.statusBarHeight || 0;
  },
  methods: {
    goBack() {
      uni.navigateBack();
    },
    goExplore(route) {
      uni.navigateTo({
        url: route.path + (route.path.includes('?') ? '&' : '?') + 'name=' + encodeURIComponent(route.name)
      });
    }
  }
}
</script>

<style lang="scss" scoped>
.container {
  background-color: #FEF9E7; // æµ…é»„è‰²/ç±³è‰²èƒŒæ™¯ï¼Œæ¯”ä¸»è‰²è°ƒæµ…
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  height: 160rpx; // è°ƒå°ä¸€ç‚¹ï¼Œå¤§çº¦æ˜¯å­—ä½“é«˜åº¦çš„2-3å€åŠ ä¸ŠçŠ¶æ€æ 
  padding: 0rpx;
  display: flex;
  align-items: center;
  background-color: #FEF9E7;
  position: relative;
  z-index: 100;
  overflow: hidden;
  border-bottom: 2rpx solid rgba(0,0,0,0.05); // ç§»é™¤ç²—é»‘è¾¹æ¡†ï¼Œæ”¹ä¸ºæµ…è‰²çº¿
  
  .header-bg-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100vw; // ç¡®ä¿æ’‘æ»¡å±å¹•å®½åº¦
    height: 100%;
    z-index: -1;
    transform: none;
  }
  
  .back-btn { 
    width: 70rpx;
    height: 70rpx;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 40rpx; 
    color: #222; 
    font-weight: 900; 
    position: absolute;
    left: 20rpx;
    // top ç”± style åŠ¨æ€è®¡ç®—
    z-index: 10;
    background: rgba(255,255,255,0.8); // å¢åŠ èƒŒæ™¯ä¸é€æ˜åº¦
    border-radius: 50%;
    box-shadow: 0 4rpx 12rpx rgba(0,0,0,0.1); // æ”¹ä¸ºé˜´å½±è€Œéé»‘è¾¹
  }
  
  .title-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding-top: 10rpx; // ç¨å¾®å‘ä¸‹åç§»ä¸€ç‚¹
  }
  
  .title { 
    font-size: 42rpx; 
    font-weight: 900; 
    color: #222; 
    letter-spacing: 4rpx;
    font-family: 'RuilingTi', sans-serif !important;
    // å¢åŠ ç™½è‰²æè¾¹/å‘å…‰ï¼Œç¡®ä¿åœ¨åœ°å›¾èƒŒæ™¯ä¸Šæ¸…æ™°
    text-shadow: 0 0 10rpx #fff, 0 0 10rpx #fff, 0 0 10rpx #fff;
  }
}

.route-list {
  flex: 1;
  padding: 30rpx; 
  padding-top: 40rpx;
  box-sizing: border-box;
}

.route-card-container {
  position: relative;
  width: 100%;
  height: 320rpx;
  margin-bottom: 70rpx; // å¢åŠ é—´è·
  display: flex;
  align-items: flex-end;
}

.art-img {
  position: absolute;
  z-index: 10;
  pointer-events: none;
  filter: drop-shadow(6rpx 10rpx 0rpx rgba(0,0,0,0.15));
  
  &.laojie {
    width: 360rpx;
    height: 360rpx;
    left: -40rpx;
    top: -70rpx;
  }
  
  &.xican {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -30rpx;
  }
  
  &.dengshan, &.binhai {
    width: 330rpx;
    height: 330rpx;
    left: -20rpx;
    top: -40rpx;
  }
  
  &.kafei {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -20rpx;
  }
}

.route-card-body {
  position: relative;
  width: 100%;
  height: 270rpx;
  border-radius: 40rpx 60rpx 45rpx 55rpx;
  // border: 5rpx solid #222; // ç§»é™¤é»‘è‰²è¾¹æ¡†
  box-shadow: 0 10rpx 30rpx rgba(0,0,0,0.08); // æ”¹ä¸ºæŸ”å’Œçš„é˜´å½±
  overflow: visible; // å…è®¸æŒ‰é’®æº¢å‡º
  
  .card-bg {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1;
    border-radius: 35rpx 55rpx 40rpx 50rpx;
  }
}

.card-content {
  position: relative;
  z-index: 5;
  width: 100%;
  height: 100%;
  display: flex;
  padding-left: 260rpx; 
  padding-right: 0rpx;
  box-sizing: border-box;
  align-items: flex-start; // æ”¹ä¸ºé¡¶éƒ¨å¯¹é½ï¼Œæ–¹ä¾¿æ§åˆ¶æ–‡å­—ä½ç½®
  padding-top: 30rpx;
  
  .text-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    
    .route-header {
      display: flex;
      align-items: center;
      margin-bottom: 8rpx;
      
      .name { 
        font-size: 38rpx; 
        font-weight: 900; 
        color: #222; 
        letter-spacing: 2rpx;
        font-family: 'RuilingTi', sans-serif !important;
      }
      .arrow-double { 
        font-size: 32rpx; 
        color: #222; 
        margin-left: 10rpx;
        font-weight: 900;
      }
    }
    
    .route-desc {
      font-size: 24rpx;
      color: #444;
      line-height: 1.4;
      font-weight: 800;
      font-family: 'RuilingTi', sans-serif !important;
      padding-right: 120rpx; // å¢åŠ å³è¾¹è·ï¼Œé¿å…è¢«åœ†åœˆæŒ¡ä½
      white-space: pre-wrap; // æ”¯æŒæ¢è¡Œç¬¦
      letter-spacing: 1rpx;
    }
  }
}

.explore-side {
  position: absolute;
  right: -35rpx; // å‘å³ç§»åŠ¨ï¼ˆç›¸å¯¹äºå³è¾¹ç•Œå‘å¤–åç§»ï¼‰
  bottom: 35rpx; // å‘ä¸Šç§»åŠ¨
  width: 150rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-end;
  box-sizing: border-box;
  z-index: 20;
  
  .circle-btn {
    width: 125rpx;
    height: 125rpx;
    background: linear-gradient(135deg, #FFB800 0%, #FF8A00 100%);
    border-radius: 50%;
    // border: 5rpx solid #222; // åŒæ ·ç§»é™¤æŒ‰é’®çš„ç²—é»‘è¾¹æ¡†
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 8rpx 20rpx rgba(255, 138, 0, 0.4); // æ”¹ä¸ºå½©è‰²é˜´å½±
    
    .btn-text {
      font-size: 28rpx;
      font-weight: 900;
      color: #fff;
      font-family: 'RuilingTi', sans-serif !important;
      line-height: 1.1;
      text-align: center;
      width: 60rpx;
      word-break: break-all;
    }
    
    &:active {
      transform: scale(0.9) rotate(-10deg);
      opacity: 0.9;
    }
  }
}

.bottom-padding { height: 100rpx; }

@keyframes slideDown {
  from { transform: translateY(-40rpx); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-slide-down { animation: slideDown 0.6s ease-out both; }
.animate-fade-in { animation: fadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1) both; }
</style>
