<template>
  <view class="container">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <view class="header animate-slide-down">
      <SafeImage class="header-bg-img" :src="assets.route.headerBgMap" mode="aspectFit">
        <template #error>
          <view class="error-placeholder">
            <text>ğŸ¯ è·¯çº¿é€‰æ‹©èƒŒæ™¯åŠ è½½å¤±è´¥</text>
            <text>{{ assets.route.headerBgMap }}</text>
          </view>
        </template>
      </SafeImage>
      <view class="back-btn" @click="goBack">â†</view>
      <view class="title-container">
        <!-- ç§»é™¤ä»£ç é‡Œçš„æ ‡é¢˜æ–‡å­—ï¼Œå› ä¸ºèƒŒæ™¯å›¾é‡Œå·²ç»æœ‰æ¼‚äº®çš„â€œè·¯çº¿é€‰æ‹©â€å­—æ ·äº†ï¼Œé¿å…é‡å  -->
        <!-- <text class="title">è·¯çº¿é€‰æ‹©</text> -->
      </view>
    </view>
    
    <scroll-view scroll-y class="route-list">
      <view 
        v-for="(route, index) in routes" 
        :key="index" 
        class="route-card-container animate-fade-in" 
        :style="{animationDelay: index * 0.15 + 's'}"
        @click="goExplore(route)"
      >
        <!-- è£…é¥°è‰ºæœ¯å›¾ (æº¢å‡ºå¡ç‰‡å¤–éƒ¨) -->
        <image class="art-img" :src="route.artImg" mode="aspectFit" :class="route.id"></image>

        <view class="route-card-body">
          <!-- èƒŒæ™¯å›¾ (å¸¦åˆ‡å£å’Œé˜´å½±çš„é»„è‰²åº•) -->
          <image class="card-bg" :src="route.bg" mode="scaleToFill"></image>
          
          <view class="card-content">
            <view class="text-area">
              <view class="route-header">
                <text class="name">{{ route.name }}</text>
                <text class="arrow-double">â‰«</text>
              </view>
              <view class="route-desc">{{ route.desc }}</view>
            </view>
            
            <!-- å³ä¾§æ¢ç´¢æŒ‰é’®åŒºåŸŸ -->
            <view class="explore-side">
              <view class="circle-btn">
                <text class="btn-text">å»æ¢ç´¢</text>
              </view>
            </view>
          </view>
        </view>
      </view>
      <view class="bottom-padding"></view>
    </scroll-view>
  </view>
</template>

<script>
import SafeImage from '@/components/SafeImage.vue'
import { ASSETS_CONFIG } from '@/utils/assets-config.js'

export default {
  components: {
    SafeImage
  },
  data() {
    return {
      assets: ASSETS_CONFIG,
      routes: [
        {
          id: 'laojie',
          name: 'è€è¡—è·¯çº¿',
          desc: 'è›‡å£è€è¡—æ¼«æ­¥è·¯çº¿ï¼Œä»æ—¶ä»£æ ‡ç­¾å¯ç¨‹ï¼Œç»å·¥ä¸šæ—§å€ã€æ–‡åˆ›åœ°æ ‡ä¸äººæ–‡æ™¯ç‚¹ï¼Œå°½è§ˆå¼€æ‹“è¿‡å¾€ä¸è¯—æ„å±±æµ·ã€‚',
          bg: ASSETS_CONFIG.route.cardBg1,
          artImg: ASSETS_CONFIG.route.oldstreetShip,
          path: '/pages/route/detail?id=laojie'
        },
        {
          id: 'dengshan',
          name: 'ç™»å±±è·¯çº¿',
          desc: 'ä» "æ—¶é—´å°±æ˜¯é‡‘é’±ï¼Œæ•ˆç‡å°±æ˜¯ç”Ÿå‘½" æ ‡è¯­ç‰Œèµ·æ­¥ï¼Œæ²¿å¾®æ³¢å±±æ­¥é“ç¼“æ­¥ç™»é«˜ï¼Œå±±æµ·ç›¸ä¼´ï¼Œç»ˆç‚¹æŠµè¾¾æ‹›å•†å±€å†å²åšç‰©é¦†ï¼Œä¸€è·¯è§è¯è›‡å£çš„æ”¹é©ç²¾ç¥ä¸ç™¾å¹´å˜è¿ã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.mountainArt,
          path: '/pages/route/detail?id=dengshan'
        },
        {
          id: 'binhai',
          name: 'æ»¨æµ·è·¯çº¿',
          desc: 'ä»æµ·ä¸Šä¸–ç•Œæ˜åè½®å¯èˆªï¼Œç»å¥³å¨²è¡¥å¤©é›•åƒä¸æ–‡åŒ–è‰ºæœ¯ä¸­å¿ƒçš„è¢åºšå±•ï¼Œå†åˆ°å—æµ·é…’åº—ä¸ç¢§æ¶›è‹‘åˆ«å¢…ç¾¤ï¼Œä¸€è·¯æµ·é£ç›¸ä¼´ï¼Œå°½è§ˆè›‡å£çš„å¼€æ”¾æ°”è´¨ä¸æ»¨æµ·é£æƒ…ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.seaArt,
          path: '/pages/route/detail?id=binhai'
        },
        {
          id: 'xican',
          name: 'è¥¿é¤è·¯çº¿',
          desc: 'è›‡å£è¥¿é¤çº¿æ¡å›½é™…é£å‘³ï¼šå®å¯å¤šã€æ±‰å ¡ã€æ„å¼æŠ«è¨ã€æ ¼é²å‰äºšèœï¼Œå¤šç§é€‰æ‹©ï¼Œå®¶å®¶æœ‰æƒŠå–œã€‚',
          bg: ASSETS_CONFIG.route.cardBg2,
          artImg: ASSETS_CONFIG.route.westernPizza,
          path: '/pages/route/detail?id=xican'
        },
        {
          id: 'kafei',
          name: 'å’–å•¡è·¯çº¿',
          desc: 'è›‡å£å’–å•¡æ¼«æ¸¸è·¯çº¿ï¼Œæ˜¯ä¸€åœºä¸é¦™æ°”çš„æ¸©æŸ”é‚‚é€…ã€‚ä¸²è”åå®¶ç‰¹è‰²å’–å•¡é¦†ï¼Œæ…¢å“é—´ï¼Œä¾¿è¯»æ‡‚äº†è›‡å£ã€‚',
          bg: ASSETS_CONFIG.route.cardBg3,
          artImg: ASSETS_CONFIG.route.coffeeTools,
          path: '/pages/route/detail?id=kafei'
        }
      ]
    }
  },
  methods: {
    goBack() {
      uni.navigateBack();
    },
    goExplore(route) {
      uni.navigateTo({
        url: route.path + (route.path.includes('?') ? '&' : '?') + 'name=' + encodeURIComponent(route.name)
      });
    }
  }
}
</script>

<style lang="scss" scoped>
.container {
  background-color: #FEF9E7; // æµ…é»„è‰²/ç±³è‰²èƒŒæ™¯ï¼Œæ¯”ä¸»è‰²è°ƒæµ…
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.header {
  height: 360rpx; // è¿›ä¸€æ­¥è°ƒé«˜ï¼Œç»™æ‰‹ç»˜å›¾ç•™å‡ºå®Œæ•´ç©ºé—´
  padding: 0rpx;
  display: flex;
  align-items: center;
  background-color: #FEF9E7;
  position: relative;
  z-index: 100;
  overflow: hidden;
  border-bottom: 6rpx solid #222;
  
  .header-bg-img {
    position: absolute;
    top: 20rpx; // å‘ä¸‹åç§»ä¸€ç‚¹ï¼Œé¿å¼€é¡¶éƒ¨çŠ¶æ€æ 
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    // ä½¿ç”¨ aspectFit å¹¶å»æ‰æ‹‰ä¼¸ç›¸å…³çš„ transform
    transform: none;
  }
  
  .back-btn { 
    width: 80rpx;
    height: 80rpx;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 50rpx; 
    color: #222; 
    font-weight: 900; 
    position: absolute;
    left: 20rpx;
    top: 130rpx; 
    z-index: 10;
    background: rgba(255,255,255,0.3); // å¢åŠ æ¯›ç»ç’ƒèƒŒæ™¯
    border-radius: 50%;
    backdrop-filter: blur(5px);
  }
  
  .title-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    padding-top: 110rpx; 
  }
  
  .title { 
    font-size: 48rpx; 
    font-weight: 900; 
    color: #222; 
    letter-spacing: 6rpx;
    font-family: 'RuilingTi', sans-serif !important; // ä½¿ç”¨æ–°å­—ä½“
    text-shadow: 4rpx 4rpx 0rpx rgba(255, 255, 255, 0.8);
  }
}

.route-list {
  flex: 1;
  padding: 30rpx; 
  box-sizing: border-box;
}

.route-card-container {
  position: relative;
  width: 100%;
  height: 320rpx;
  margin-bottom: 60rpx;
  display: flex;
  align-items: flex-end;
}

.art-img {
  position: absolute;
  z-index: 10;
  pointer-events: none;
  // æ”¹ä¸ºç¡¬é˜´å½±
  filter: drop-shadow(6rpx 10rpx 0rpx rgba(0,0,0,0.15));
  
  &.laojie {
    width: 340rpx;
    height: 340rpx;
    left: -30rpx;
    top: -50rpx;
  }
  
  &.xican {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -30rpx;
  }
  
  &.dengshan, &.binhai {
    width: 320rpx;
    height: 320rpx;
    left: -20rpx;
    top: -30rpx;
  }
  
  &.kafei {
    width: 300rpx;
    height: 300rpx;
    left: -10rpx;
    top: 0rpx;
  }
}

.route-card-body {
  position: relative;
  width: 100%;
  height: 270rpx;
  border-radius: 40rpx 60rpx 45rpx 55rpx; // ä½¿ç”¨ä¸è§„åˆ™åœ†è§’
  border: 5rpx solid #222; // å¢åŠ é»‘è¾¹
  box-shadow: 12rpx 12rpx 0rpx rgba(0,0,0,0.1); // å¢åŠ åšé‡é˜´å½±
  overflow: hidden;
  
  .card-bg {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    z-index: 1;
  }
}

.card-content {
  position: relative;
  z-index: 5;
  width: 100%;
  height: 100%;
  display: flex;
  padding-left: 270rpx; 
  padding-right: 0rpx;
  box-sizing: border-box;
  align-items: center;
  
  .text-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding-top: 10rpx;
    
    .route-header {
      display: flex;
      align-items: center;
      margin-bottom: 12rpx;
      
      .name { 
        font-size: 38rpx; 
        font-weight: 900; 
        color: #222; 
        letter-spacing: 2rpx;
        font-family: 'RuilingTi', sans-serif !important; // ä½¿ç”¨æ–°å­—ä½“
      }
      .arrow-double { 
        font-size: 32rpx; 
        color: #222; 
        margin-left: 10rpx;
        font-weight: 900;
      }
    }
    
    .route-desc {
      font-size: 24rpx;
      color: #444;
      line-height: 1.4;
      font-weight: 800; // è°ƒç²—ä¸€ç‚¹ï¼Œé…åˆæ•´ä½“æ’ç”»é£æ ¼
      font-family: 'RuilingTi', sans-serif !important; // ä½¿ç”¨æ–°å­—ä½“
      padding-right: 90rpx; 
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3;
      overflow: hidden;
      letter-spacing: 1rpx;
    }
  }
}

.explore-side {
  position: absolute;
  right: -30rpx; 
  top: 0;
  bottom: 0;
  width: 180rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  
  .circle-btn {
    width: 120rpx;
    height: 120rpx;
    background: linear-gradient(135deg, #FFB800 0%, #FF8A00 100%);
    border-radius: 50%;
    border: 5rpx solid #222; // å¢åŠ æè¾¹
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 8rpx 8rpx 0rpx rgba(0, 0, 0, 0.15); // æ”¹ä¸ºæ’ç”»ç¡¬é˜´å½±
    margin-right: 20rpx;
    
    .btn-text {
      font-size: 28rpx;
      font-weight: 900;
      color: #fff;
      font-family: 'RuilingTi', sans-serif !important;
      line-height: 1.1;
      text-align: center;
      width: 70rpx; // å¼ºåˆ¶ä¸¤è¡Œ
      word-break: break-all;
    }
    
    &:active {
      transform: scale(0.9) rotate(-10deg);
      opacity: 0.9;
    }
  }
}

.bottom-padding { height: 100rpx; }

@keyframes slideDown {
  from { transform: translateY(-40rpx); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.95); }
  to { opacity: 1; transform: scale(1); }
}

.animate-slide-down { animation: slideDown 0.6s ease-out both; }
.animate-fade-in { animation: fadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1) both; }
</style>
